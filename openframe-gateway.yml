server:
  port: 8100

# Gateway service common configuration
spring:
  main:
    web-application-type: reactive
  redis:
    enabled: true
    timeout: 2000
    connect-timeout: 2000
    lettuce:
      shutdown-timeout: 2000ms
      pool:
        enabled: true
        max-active: 8
        max-idle: 8
        min-idle: 0
        max-wait: 1000ms
    client-type: lettuce
  data:
    cassandra:
      enabled: true
    mongodb:
      enabled: true
  cloud:
    config:
      fail-fast: false
    gateway:
      httpclient:
        ssl:
          useInsecureTrustManager: true
        websocket:
          max-frame-payload-length: 1048576 #1MB
      routes:
        - id: sas
          uri: https://localhost:9005
          predicates:
            - Path=/sas/**
          order: 0

        # Direct Swagger/OpenAPI routes (for Swagger UI JavaScript requests)
        - id: swagger-api-docs
          uri: http://openframe-external-api.microservices.svc.cluster.local:8092
          predicates:
            - Path=/api-docs/**
          order: 0

        - id: swagger-ui-direct
          uri: http://openframe-external-api.microservices.svc.cluster.local:8092
          predicates:
            - Path=/swagger-ui/**
          order: 0

        - id: swagger-webjars
          uri: http://openframe-external-api.microservices.svc.cluster.local:8092
          predicates:
            - Path=/webjars/**
          order: 0

        - id: openframe-external-api
          uri: http://openframe-external-api.microservices.svc.cluster.local:8092
          predicates:
            - Path=/external-api/**
          filters:
            - StripPrefix=1

        - id: openframe-api
          uri: http://openframe-api.microservices.svc.cluster.local:8090
          predicates:
            - Path=/api/**
          filters:
            - StripPrefix=1

        - id: openframe-client
          uri: http://openframe-client.microservices.svc.cluster.local:8097
          predicates:
            - Path=/clients/**
          filters:
            - StripPrefix=1

        - id: openframe-ui-spa
          uri: http://openframe-ui.microservices.svc.cluster.local:3000
          predicates:
            - Path=/**

# Rate limiting configuration
openframe:
  rate-limit:
    enabled: true
    default-requests-per-minute: 5
    default-requests-per-hour: 1000
    default-requests-per-day: 10000
    redis-ttl: 7200        # 2 hours in seconds
    fail-open: true
    log-violations: true
    include-headers: true
  security:
    cookie:
      domain: null
      secure: true   # true for HTTPS, false for HTTP


  # API Key Statistics configuration
  api-key-stats:
    redis-ttl: 604800      # 7 days in seconds

management:
  server:
    port: 8101

jwt:
  issuer: https://auth.openframe.com
  audience: openframe-web
  publicKey:
    value: |
      -----BEGIN PUBLIC KEY-----
      MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA2hOutXmTOhEp7FHCXRpn
      6rkyeQRStHcNe5GF/+6fejfP7N4lIAe33YGyrlLB8++p2/RcWYd6ZBNb7mYX/XaI
      cRpsgraHxMjsQ8Lyio8QkuDX7HFzW5W4MFGMSBYv8zK95FNPGGK2LEdRf+DtaYzk
      XpqrkJTgfw7jFqEVCiC9Eg6ryHO0UppDjb8ho2XZIpWgAcW4Qf+iXaRWCR+FN4tR
      9LF/vBmqH13CQD9jazqSTR5mMp9ih9sG0SqEAYxAhENXtLjf+yH2uDplu0RaFkuv
      ec8Qg5aglrDzTK4wpF1avJXCmndDt2VbfMMCehiLI31LPm8qNoJo87KF71gvE+kW
      cQIDAQAB
      -----END PUBLIC KEY-----